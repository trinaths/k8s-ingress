{
  "$schema": "https://raw.githubusercontent.com/F5Networks/f5-appsvcs-extension/master/schema/latest/as3-schema-3.11.0-3.json",
  "class": "AS3",
  "declaration": {
    "class": "ADC",
    "id": "urn:uuid:B97DFADF-9F0D-4F6C-8D66-E9B52E593694",
    "label": "CIS Declaration",
    "remark": "Auto-generated by CIS",
    "schemaVersion": "3.11.0",
    "test_AS3": {
      "Shared": {
        "Ingress_172_16_3_3_80": {
          "class": "Endpoint_Policy",
          "rules": [
            {
              "name": "app_root_redirect_rule_foo_com_approot1",
              "conditions": [
                {
                  "type": "httpHeader",
                  "name": "host",
                  "event": "request",
                  "all": {
                    "values": [
                      "foo.com"
                    ],
                    "operand": "equals"
                  }
                },
                {
                  "type": "httpUri",
                  "name": "1",
                  "event": "request",
                  "path": {
                    "values": [
                      "/"
                    ],
                    "operand": "equals"
                  }
                }
              ],
              "actions": [
                {
                  "type": "httpRedirect",
                  "event": "request",
                  "location": "/approot1"
                }
              ]
            },
            {
              "name": "app_root_redirect_rule_bar_com_approot2",
              "conditions": [
                {
                  "type": "httpHeader",
                  "name": "host",
                  "event": "request",
                  "all": {
                    "values": [
                      "bar.com"
                    ],
                    "operand": "equals"
                  }
                },
                {
                  "type": "httpUri",
                  "name": "1",
                  "event": "request",
                  "path": {
                    "values": [
                      "/"
                    ],
                    "operand": "equals"
                  }
                }
              ],
              "actions": [
                {
                  "type": "httpRedirect",
                  "event": "request",
                  "location": "/approot2"
                }
              ]
            },
            {
              "name": "app_root_forward_rule_foo_com_approot1",
              "conditions": [
                {
                  "type": "httpHeader",
                  "name": "host",
                  "event": "request",
                  "all": {
                    "values": [
                      "foo.com"
                    ],
                    "operand": "equals"
                  }
                },
                {
                  "type": "httpUri",
                  "name": "1",
                  "event": "request",
                  "path": {
                    "values": [
                      "/approot1"
                    ],
                    "operand": "equals"
                  }
                }
              ],
              "actions": [
                {
                  "type": "forward",
                  "event": "request",
                  "select": {
                    "pool": {
                      "use": "ingress_default_svc_1"
                    }
                  }
                }
              ]
            },
            {
              "name": "app_root_forward_rule_bar_com_approot2",
              "conditions": [
                {
                  "type": "httpHeader",
                  "name": "host",
                  "event": "request",
                  "all": {
                    "values": [
                      "bar.com"
                    ],
                    "operand": "equals"
                  }
                },
                {
                  "type": "httpUri",
                  "name": "1",
                  "event": "request",
                  "path": {
                    "values": [
                      "/approot2"
                    ],
                    "operand": "equals"
                  }
                }
              ],
              "actions": [
                {
                  "type": "forward",
                  "event": "request",
                  "select": {
                    "pool": {
                      "use": "ingress_default_svc_2"
                    }
                  }
                }
              ]
            },
            {
              "name": "ingress_foo_com_approot1_ingress_default_svc_1",
              "conditions": [
                {
                  "type": "httpHeader",
                  "name": "host",
                  "event": "request",
                  "all": {
                    "values": [
                      "foo.com"
                    ],
                    "operand": "equals"
                  }
                },
                {
                  "type": "httpUri",
                  "name": "1",
                  "event": "request",
                  "index": 1,
                  "pathSegment": {
                    "values": [
                      "approot1"
                    ],
                    "operand": "equals"
                  }
                }
              ],
              "actions": [
                {
                  "type": "forward",
                  "event": "request",
                  "select": {
                    "pool": {
                      "use": "ingress_default_svc_1"
                    }
                  }
                }
              ]
            },
            {
              "name": "ingress_bar_com_approot2_ingress_default_svc_2",
              "conditions": [
                {
                  "type": "httpHeader",
                  "name": "host",
                  "event": "request",
                  "all": {
                    "values": [
                      "bar.com"
                    ],
                    "operand": "equals"
                  }
                },
                {
                  "type": "httpUri",
                  "name": "1",
                  "event": "request",
                  "index": 1,
                  "pathSegment": {
                    "values": [
                      "approot2"
                    ],
                    "operand": "equals"
                  }
                }
              ],
              "actions": [
                {
                  "type": "forward",
                  "event": "request",
                  "select": {
                    "pool": {
                      "use": "ingress_default_svc_2"
                    }
                  }
                }
              ]
            }
          ],
          "strategy": "first-match"
        },
        "class": "Application",
        "ingress_172_16_3_3_80": {
          "layer4": "tcp",
          "source": "0.0.0.0/0",
          "translateServerAddress": true,
          "translateServerPort": true,
          "class": "Service_HTTP",
          "profileHTTP": {
            "bigip": "/Common/http"
          },
          "profileTCP": {
            "bigip": "/Common/tcp"
          },
          "virtualAddresses": [
            "172.16.3.3"
          ],
          "virtualPort": 80,
          "snat": "auto",
          "policyEndpoint": "/test_AS3/Shared/Ingress_172_16_3_3_80"
        },
        "ingress_default_svc_1": {
          "class": "Pool",
          "loadBalancingMode": "round-robin",
          "members": [
            {
              "addressDiscovery": "static",
              "serverAddresses": [
                "10.129.1.2"
              ],
              "servicePort": 80
            }
          ]
        },
        "ingress_default_svc_2": {
          "class": "Pool",
          "loadBalancingMode": "round-robin",
          "members": [
            {
              "addressDiscovery": "static",
              "serverAddresses": [
                "10.129.1.3"
              ],
              "servicePort": 80
            }
          ]
        },
        "template": "shared"
      },
      "class": "Tenant"
    }
  }
}
